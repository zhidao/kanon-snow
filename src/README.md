# KANON雪降るアニメーション by Zhidao
                                                2003.10.31. 作成
                                                2024. 2.16. 最終更新
--------------------------------------------------------------------
## 【何？】

KANON (C)Key/VisualArts の中の幕間シーンで使われる雪降りアニメーショ
ンを再現するプログラムです。
ZX11のスプライト機能＆国際化文字列表示のサンプルとして作ったものです。
何の役にも立ちませんが、はらはらと降る雪、流れては消えていく言の葉を
見つめてぼーっとしたい方にお勧めです。

--------------------------------------------------------------------
## 【インストール方法】

XPM, ZEDA及びZX11が必要です。

XPM   http://koala.ilog.fr/lehors/xpm.html
ZEDA  https://github.com/zhidao/zeda
ZX11  https://github.com/zhidao/zx11

予め全てをインストールした後、パスを通しておいて下さい。

必要に応じてmakefileのPREFIX、MSG_PATH、MSGを変更して下さい。
PREFIX   インストール先ディレクトリ(実行ファイルは$(PREFIX)/binに置
         かれます)(デフォルトでは/usrです)。
MSG_PATH メッセージインストール先ディレクトリ(デフォルトでは
         /etc/kanon-snow となります)。
MSG      メッセージファイルを指定しなかったときに読まれるファイル
         (デフォルトではmessageとなります)。

% make

で実行ファイルkanon-snowが出来ます。また、

% make install

で、実行ファイルを$(PREFIX)/binに、メッセージファイルを$(MSG_PATH)の
下にそれぞれインストールします。

あるいは、たとえば
% make MSG_PATH=$HOME/.kanon-snow
% make MSG_PATH=$HOME/.kanon-snow PREFIX=$HOME/usr install
のように、makeの引数でそれぞれを変更することもできます。

--------------------------------------------------------------------
## 【実行時オプション】

-h, -help  オプション一覧を表示します。
-p, -path  メッセージファイルのあるパスを指定します。
          このオプションがなかった場合、MSG_PATHを見にいきます。
-m, -msg   メッセージファイルを直接指定します。
           MSG_PATHが存在しない場合、カレントディレクトリから探します。
-v         実行状況を詳しくレポートします。

例:
% kanon-snow
% kanon-snow -path ~/.kanon-snow
% kanon-snow -msg my_message

なお、'q'キーで終了します。

--------------------------------------------------------------------
## 【メッセージファイルについて】

メッセージファイルは任意のテキストファイルを指定できます。
メッセージファイル中、各メッセージ間の空行は自動的にスキップされます。

--------------------------------------------------------------------
## 【改造のポイント】

kanon-snow.hファイル中のマクロをいじることで、雪の落下速度やメッセー
ジのスクロール速度などを調節できます。

### <雪の動き>

※ _Sは小さい雪、 _Lは大きい雪のパラメータをそれぞれ意味します。
左右への揺れ幅:
KS_SNOW_AMP_S          8
KS_SNOW_AMP_L         12

落下速度の範囲:
KS_SNOW_SPEED_S_MIN    1
KS_SNOW_SPEED_S_MAX    2
KS_SNOW_SPEED_L_MIN    2
KS_SNOW_SPEED_L_MAX    4

左右への揺れの速さ:
KS_SNOW_DPHASE         0.005

雪の数（一画面中の最大同時表示数）:
KS_SNOW_S_NUM         16
KS_SNOW_L_NUM          8

### <メッセージの動き>

メッセージが表示される範囲の、ウィンドウ中央からの上下幅:
KS_MSG_DY             80

メッセージが消えて次のメッセージが表示されるまでの時間:
KS_MSG_FADE_DY        20

メッセージ落下速度:
KS_MSG_SPEED           1

最後のメッセージがフェードイン/フェードアウトする時間:
KS_MSG_LAST_COUNT    100

--------------------------------------------------------------------
## 【配布に関する注意・免責事項】

本アーカイブの利用、配布は自由に行って構いません。但しアーカイブの中
身は変更しないで下さい。また、本アーカイブを利用した結果起こったいか
なる事態に対しても、作者は責任を負いかねますのでご了承下さい。

KANONはKey/VisualArtsの作品です。本作品は、同社のご好意により二次創
作物として無償での配布を許されております。ここに感謝申し上げます。
本作品についてのVisualArtsへの問い合わせは御遠慮下さい。

--------------------------------------------------------------------
## 【連絡先】

バグ情報、ご感想、ご質問、ご意見、ご希望、ご苦情など、何かござい
ましたらお気軽にどしどしお申しつけ下さいませ。

URL    http://www.ric.hi-ho.ne.jp/z-lab/
E-mail zhidao@ieee.org

--------------------------------------------------------------------
## 【履歴】

2024. 2.16. ver2.1。makefileおよびこのドキュメントを修正。
            UTF-8ファイルのByte Order Markerをスキップする処理を追加。
2020.10.26. このドキュメントを修正。
2020. 9. 8. ver2.0。ZEDA（旧CURE）、ZX11の最新仕様に合わせ修正。
2007.11.17. ver1.8。CURE、ZX11のバージョンアップに合わせ修正。
            実行時に'q'キー入力で終了するようにした。
2006. 2. 7. ver1.7。ZBLからCUREへの移行に合わせ修正。
2004.12.30. ver1.6。zx11 ver0.9.0.での仕様変更に合わせ細々と修正。
2004.10.22. ver1.5。zx11 ver0.7.7.での仕様変更に合わせ細々と修正。
2004. 2.29. ver1.4。g++ 3.3.3でのコンパイル時に警告される内容を解決。
2003.11. 5. ver1.3作成。メッセージファイルを指定されたパスから探すよ
            うにした。また、メッセージのグラデーション変化をsqrtから
            2乗に変更。
2003.11. 3. ver1.2作成。表示パラメータを若干修正。最後の一文のアニメ
            ーションパターンを変更(オリジナルに準じた)。
2003.11. 1. ver1.1作成。アニメーション速度がなるべくCPUスペックに依存
            しないように変更(したつもり)。また、メッセージのグラデー
            ション変化をリニアからsqrtに変更。
2003.10.31. ver1.0作成。
